<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AEGIS-HIDRS é˜²ç«å¢™ç®¡ç†ä¸­å¿ƒ</title>
    <link rel="icon" href="/static/favicon.ico" type="image/x-icon">

    <!-- Bootstrap & Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">

    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.2.0/dist/chart.umd.min.js"></script>

    <style>
        body {
            padding-top: 2rem;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        .aegis-header {
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            color: white;
            padding: 2rem 0;
            margin-bottom: 2rem;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }

        .aegis-logo {
            font-size: 3rem;
            text-shadow: 0 0 20px rgba(255,255,255,0.5);
        }

        .stat-card {
            background: white;
            border-radius: 15px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            transition: all 0.3s;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.2);
        }

        .stat-value {
            font-size: 2.5rem;
            font-weight: bold;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .status-badge {
            display: inline-block;
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-weight: bold;
            font-size: 0.9rem;
        }

        .status-online {
            background: #10b981;
            color: white;
        }

        .status-warning {
            background: #f59e0b;
            color: white;
        }

        .status-offline {
            background: #ef4444;
            color: white;
        }

        .threat-indicator {
            padding: 1rem;
            border-left: 4px solid #667eea;
            margin-bottom: 1rem;
            background: #f8f9fa;
            border-radius: 5px;
        }

        .threat-critical { border-left-color: #ef4444; }
        .threat-high { border-left-color: #f59e0b; }
        .threat-medium { border-left-color: #10b981; }
        .threat-low { border-left-color: #3b82f6; }

        .chart-container {
            background: white;
            padding: 1.5rem;
            border-radius: 15px;
            margin-bottom: 1.5rem;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .btn-aegis {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border: none;
            color: white;
            padding: 0.75rem 2rem;
            border-radius: 25px;
            font-weight: bold;
            transition: all 0.3s;
        }

        .btn-aegis:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
            color: white;
        }

        .module-card {
            background: white;
            border-radius: 15px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
        }

        .module-status {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 8px;
        }

        .module-enabled { background: #10b981; }
        .module-disabled { background: #ef4444; }

        .pulse-animation {
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .security-alert {
            padding: 1rem;
            border-radius: 10px;
            margin-bottom: 1rem;
            animation: slideIn 0.5s;
        }

        @keyframes slideIn {
            from { transform: translateX(-100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- AEGIS Header -->
        <div class="aegis-header text-center">
            <div class="aegis-logo">ğŸ›¡ï¸ AEGIS-HIDRS</div>
            <h2>Adaptive Electronic Guardian & Intrusion Shield</h2>
            <p class="mb-0">å…¨æ¯äº’è”ç½‘é˜²å¾¡ä¸å“åº”ç³»ç»Ÿ</p>
            <div class="mt-3">
                <span class="status-badge status-online pulse-animation">â— ç³»ç»Ÿè¿è¡Œä¸­</span>
            </div>
        </div>

        <!-- Navigation -->
        <div class="row mb-4">
            <div class="col-md-12">
                <nav class="navbar navbar-expand-lg navbar-light bg-white rounded shadow-sm">
                    <div class="container-fluid">
                        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                            <span class="navbar-toggler-icon"></span>
                        </button>
                        <div class="collapse navbar-collapse" id="navbarNav">
                            <ul class="navbar-nav">
                                <li class="nav-item"><a class="nav-link" href="/">ğŸ  é¦–é¡µ</a></li>
                                <li class="nav-item"><a class="nav-link" href="/search">ğŸ” æœç´¢</a></li>
                                <li class="nav-item"><a class="nav-link" href="/dashboard">ğŸ“Š ä»ªè¡¨ç›˜</a></li>
                                <li class="nav-item"><a class="nav-link active" href="/aegis_firewall">ğŸ›¡ï¸ AEGISé˜²ç«å¢™</a></li>
                            </ul>
                            <ul class="navbar-nav ms-auto">
                                <li class="nav-item">
                                    <button class="btn btn-aegis btn-sm" onclick="refreshData()">
                                        <i class="bi bi-arrow-clockwise"></i> åˆ·æ–°æ•°æ®
                                    </button>
                                </li>
                            </ul>
                        </div>
                    </div>
                </nav>
            </div>
        </div>

        <!-- Statistics Overview -->
        <div class="row mb-4">
            <div class="col-md-3">
                <div class="stat-card">
                    <h6 class="text-muted mb-2">æ€»å°åŒ…æ•°</h6>
                    <div class="stat-value" id="total-packets">12,458</div>
                    <small class="text-muted">ä»Šæ—¥å¤„ç†</small>
                </div>
            </div>
            <div class="col-md-3">
                <div class="stat-card">
                    <h6 class="text-muted mb-2">é˜»æ–­æ”»å‡»</h6>
                    <div class="stat-value text-danger" id="blocked-packets">342</div>
                    <small class="text-muted">å¨èƒå·²æ‹¦æˆª</small>
                </div>
            </div>
            <div class="col-md-3">
                <div class="stat-card">
                    <h6 class="text-muted mb-2">Spamhausé˜»æ–­</h6>
                    <div class="stat-value text-warning" id="spamhaus-blocks">28</div>
                    <small class="text-muted">æ¶æ„IPæ¥æº</small>
                </div>
            </div>
            <div class="col-md-3">
                <div class="stat-card">
                    <h6 class="text-muted mb-2">é‚®ä»¶é’“é±¼</h6>
                    <div class="stat-value text-info" id="email-phishing">15</div>
                    <small class="text-muted">å·²é˜»æ­¢</small>
                </div>
            </div>
        </div>

        <!-- Defense Modules Status -->
        <div class="row mb-4">
            <div class="col-md-12">
                <div class="module-card">
                    <h4 class="mb-3"><i class="bi bi-shield-check"></i> é˜²å¾¡æ¨¡å—çŠ¶æ€</h4>
                    <div class="row">
                        <div class="col-md-3">
                            <div class="mb-2">
                                <span class="module-status module-enabled"></span>
                                <strong>å¿«é€Ÿè¿‡æ»¤æ¸…å•</strong>
                                <div class="small text-muted">Spamhaus + é‚®ä»¶å®‰å…¨ + ç°åå•</div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="mb-2">
                                <span class="module-status module-enabled"></span>
                                <strong>æ”»å‡»è®°å¿†ç³»ç»Ÿ</strong>
                                <div class="small text-muted">SOSAå¢å¼ºç‰ˆ</div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="mb-2">
                                <span class="module-status module-enabled"></span>
                                <strong>æ™ºèƒ½èµ„æºè°ƒåº¦</strong>
                                <div class="small text-muted">ET-WCNé™æ¸©ç®—æ³•</div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="mb-2">
                                <span class="module-status module-enabled"></span>
                                <strong>DNSæ±¡æŸ“é˜²å¾¡</strong>
                                <div class="small text-muted">ç¼“å­˜æŠ•æ¯’æ£€æµ‹</div>
                            </div>
                        </div>
                    </div>
                    <div class="row mt-3">
                        <div class="col-md-3">
                            <div class="mb-2">
                                <span class="module-status module-enabled"></span>
                                <strong>å¨èƒæƒ…æŠ¥è‡ªåŠ¨æ›´æ–°</strong>
                                <div class="small text-muted">6ä¸ªæƒ…æŠ¥æº</div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="mb-2">
                                <span class="module-status module-enabled"></span>
                                <strong>HLIGå¼‚å¸¸æ£€æµ‹</strong>
                                <div class="small text-muted">å›¾è°±åˆ†æ</div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="mb-2">
                                <span class="module-status module-enabled"></span>
                                <strong>SYN Cookies</strong>
                                <div class="small text-muted">é˜²SYN Flood</div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="mb-2">
                                <span class="module-status module-disabled"></span>
                                <strong>æµé‡åå°„</strong>
                                <div class="small text-muted">ç¦ç”¨ï¼ˆæ”»å‡»æ€§åŠŸèƒ½ï¼‰</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Threat Intelligence & DNS Pollution -->
        <div class="row mb-4">
            <div class="col-md-6">
                <div class="module-card">
                    <h5 class="mb-3"><i class="bi bi-database-fill-check"></i> å¨èƒæƒ…æŠ¥æ›´æ–°çŠ¶æ€</h5>
                    <table class="table table-sm">
                        <thead>
                            <tr>
                                <th>æƒ…æŠ¥æº</th>
                                <th>æ¡ç›®æ•°</th>
                                <th>ä¸Šæ¬¡æ›´æ–°</th>
                                <th>çŠ¶æ€</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>HaGeZi DNS</td>
                                <td><span class="badge bg-primary">125,483</span></td>
                                <td>2å°æ—¶å‰</td>
                                <td><span class="badge bg-success">âœ“</span></td>
                            </tr>
                            <tr>
                                <td>Malicious Domain List</td>
                                <td><span class="badge bg-primary">8,924</span></td>
                                <td>3å°æ—¶å‰</td>
                                <td><span class="badge bg-success">âœ“</span></td>
                            </tr>
                            <tr>
                                <td>URLhaus</td>
                                <td><span class="badge bg-primary">3,214</span></td>
                                <td>1å°æ—¶å‰</td>
                                <td><span class="badge bg-success">âœ“</span></td>
                            </tr>
                            <tr>
                                <td>Spamhaus ZEN</td>
                                <td><span class="badge bg-primary">å®æ—¶æŸ¥è¯¢</span></td>
                                <td>å®æ—¶</td>
                                <td><span class="badge bg-success">âœ“</span></td>
                            </tr>
                        </tbody>
                    </table>
                    <div class="text-center mt-3">
                        <button class="btn btn-sm btn-outline-primary" onclick="updateThreatIntel()">
                            <i class="bi bi-arrow-repeat"></i> ç«‹å³æ›´æ–°
                        </button>
                    </div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="module-card">
                    <h5 class="mb-3"><i class="bi bi-shield-exclamation"></i> DNSæ±¡æŸ“æ£€æµ‹</h5>
                    <div class="threat-indicator threat-low">
                        <strong>æ­£å¸¸</strong>
                        <div class="small text-muted">Transaction IDéªŒè¯: âœ“ é€šè¿‡</div>
                    </div>
                    <div class="threat-indicator threat-low">
                        <strong>æ­£å¸¸</strong>
                        <div class="small text-muted">TTLæ£€æŸ¥: âœ“ æ­£å¸¸èŒƒå›´</div>
                    </div>
                    <div class="threat-indicator threat-medium">
                        <strong>ç›‘æ§</strong>
                        <div class="small text-muted">å“åº”é€Ÿç‡é™åˆ¶: 3ä¸ªIPè¢«é™é€Ÿ</div>
                    </div>
                    <div class="alert alert-info mt-3 mb-0">
                        <strong>ç»Ÿè®¡:</strong> ä»Šæ—¥æ£€æµ‹DNSæŸ¥è¯¢ 5,247æ¬¡ï¼Œæ£€æµ‹åˆ°0æ¬¡æ±¡æŸ“æ”»å‡»
                    </div>
                </div>
            </div>
        </div>

        <!-- Charts -->
        <div class="row mb-4">
            <div class="col-md-6">
                <div class="chart-container">
                    <h5 class="mb-3">å°åŒ…å¤„ç†è¶‹åŠ¿ï¼ˆ24å°æ—¶ï¼‰</h5>
                    <canvas id="packetTrendChart" height="200"></canvas>
                </div>
            </div>
            <div class="col-md-6">
                <div class="chart-container">
                    <h5 class="mb-3">å¨èƒç±»å‹åˆ†å¸ƒ</h5>
                    <canvas id="threatTypeChart" height="200"></canvas>
                </div>
            </div>
        </div>

        <!-- Recent Alerts -->
        <div class="row mb-4">
            <div class="col-md-12">
                <div class="module-card">
                    <h5 class="mb-3"><i class="bi bi-exclamation-triangle-fill"></i> æœ€è¿‘å®‰å…¨è­¦æŠ¥</h5>
                    <div class="security-alert alert alert-danger">
                        <strong>CRITICAL</strong> - Spamhaus XBLæ£€æµ‹: æ¶æ„è½¯ä»¶/åƒµå°¸ç½‘ç»œ (IP: 1.2.3.4)
                        <span class="float-end text-muted">3åˆ†é’Ÿå‰</span>
                    </div>
                    <div class="security-alert alert alert-warning">
                        <strong>WARNING</strong> - é‚®ä»¶é’“é±¼æ£€æµ‹: ä¼ªè£…PayPalå‘ä»¶äºº
                        <span class="float-end text-muted">15åˆ†é’Ÿå‰</span>
                    </div>
                    <div class="security-alert alert alert-info">
                        <strong>INFO</strong> - ç°åå•åŒ¹é…: å¯ç–‘TLDåŸŸå (.tk)
                        <span class="float-end text-muted">28åˆ†é’Ÿå‰</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <div class="text-center text-white-50 mb-4">
            <p>AEGIS-HIDRS v4.0 | Adaptive Electronic Guardian & Intrusion Shield</p>
            <p class="small">Powered by Claude + 430 | å…¨æ¯æ‹‰æ™®æ‹‰æ–¯äº’è”ç½‘é˜²å¾¡ç³»ç»Ÿ</p>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Initialize Charts
        document.addEventListener('DOMContentLoaded', function() {
            // Packet Trend Chart
            const packetCtx = document.getElementById('packetTrendChart').getContext('2d');
            new Chart(packetCtx, {
                type: 'line',
                data: {
                    labels: ['00:00', '04:00', '08:00', '12:00', '16:00', '20:00', '24:00'],
                    datasets: [{
                        label: 'æ€»å°åŒ…',
                        data: [1200, 1900, 3000, 5000, 4200, 3800, 2500],
                        borderColor: 'rgb(102, 126, 234)',
                        backgroundColor: 'rgba(102, 126, 234, 0.1)',
                        tension: 0.4
                    }, {
                        label: 'é˜»æ–­å°åŒ…',
                        data: [50, 80, 120, 200, 150, 100, 80],
                        borderColor: 'rgb(239, 68, 68)',
                        backgroundColor: 'rgba(239, 68, 68, 0.1)',
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    }
                }
            });

            // Threat Type Chart
            const threatCtx = document.getElementById('threatTypeChart').getContext('2d');
            new Chart(threatCtx, {
                type: 'doughnut',
                data: {
                    labels: ['Spamhausé˜»æ–­', 'é‚®ä»¶é’“é±¼', 'DNSæ±¡æŸ“', 'æ¶æ„è½¯ä»¶', 'å…¶ä»–'],
                    datasets: [{
                        data: [28, 15, 8, 12, 5],
                        backgroundColor: [
                            'rgba(239, 68, 68, 0.8)',
                            'rgba(245, 158, 11, 0.8)',
                            'rgba(59, 130, 246, 0.8)',
                            'rgba(139, 92, 246, 0.8)',
                            'rgba(156, 163, 175, 0.8)'
                        ]
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });
        });

        function refreshData() {
            // Simulate data refresh
            console.log('Refreshing firewall data...');
            location.reload();
        }

        function updateThreatIntel() {
            alert('å¨èƒæƒ…æŠ¥æ›´æ–°å·²è§¦å‘ï¼\n\næ­£åœ¨ä»ä»¥ä¸‹æºè·å–æœ€æ–°æ•°æ®:\n- HaGeZi DNS Blocklists\n- Malicious Domain Threat List\n- URLhaus\n- Spamhaus ZEN\n\né¢„è®¡å®Œæˆæ—¶é—´: 2-5åˆ†é’Ÿ');
        }
    </script>
</body>
</html>
